!! Test P-brane [+...] partial application from current scope

{
    !! Basic P-brane: bind some ordinates from current scope
    f = [a, b, c, d]{r = a + b + c + d};
    a = 3;
    c = 1;
    f2 = [+a, c]f;        !! Binds a=3, c=1 from current scope
                          !! f2 still has detached ordinates b, d

    b = 2;
    d = 4;
    x =$ f2;              !! Should be 10: a=3, b=2, c=1, d=4

    !! Change scope values - f2 already captured a and c
    a = 100;
    c = 200;
    y =$ f2;              !! Should still use a=3, c=1 from capture
                          !! But b, d resolve from current scope
    !! Expected: 3 + 2 + 1 + 4 = 10 (b,d from current scope)

    !! Nested P-brane application
    {
        g = [p, q, r, s]{sum = p + q + r + s};
        p = 1;
        q = 2;
        g2 = [+p]g;       !! Partially apply p=1

        r = 3;
        g3 = [+r]g2;      !! Further partially apply r=3

        s = 4;
        z =$ [q=10]g3;    !! Provide q=10 at evaluation
                          !! Expected: p=1, q=10, r=3, s=4 = 18
    };

    !! P-brane with explicit values mixed in
    h = [a, b, c]{result = a + b + c};
    a = 5;
    h2 = [+a, b=10]h;     !! a from scope (5), b explicit (10), c detached
    c = 3;
    w =$ h2;              !! Should be 18: a=5, b=10, c=3
}
